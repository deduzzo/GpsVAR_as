{
  "backgroundColor": "#FFFFFF",
  "borderColor": "#E0DEDE",
  "borderRadius": "{{appsmith.theme.borderRadius.appBorderRadius}}",
  "borderWidth": "1",
  "bottomRow": 41,
  "bottomRowBeforeCollapse": 51,
  "boxShadow": "{{appsmith.theme.boxShadow.appBoxShadow}}",
  "defaultModel": "{{appsmith.store.orarioConvenzionatoSelezionato }}",
  "dynamicBindingPathList": [
    {
      "key": "theme"
    },
    {
      "key": "borderRadius"
    },
    {
      "key": "boxShadow"
    },
    {
      "key": "defaultModel"
    }
  ],
  "dynamicHeight": "FIXED",
  "dynamicPropertyPathList": [],
  "dynamicTriggerPathList": [
    {
      "key": "onResetClick"
    },
    {
      "key": "openModalOrarioEdit"
    },
    {
      "key": "onDeleteOrario"
    }
  ],
  "events": [
    "onResetClick",
    "openModalOrarioEdit",
    "onDeleteOrario"
  ],
  "isCanvas": false,
  "isLoading": false,
  "isSearchWildcard": true,
  "isVisible": true,
  "key": "bpmodunk2m",
  "leftColumn": 0,
  "maxDynamicHeight": 9000,
  "minDynamicHeight": 4,
  "mobileBottomRow": 49,
  "mobileLeftColumn": 36,
  "mobileRightColumn": 59,
  "mobileTopRow": 19,
  "needsErrorInfo": false,
  "onDeleteOrario": "{{orariFunctions.onDeleteOrario(rowIndex);}}",
  "onResetClick": "{{showAlert('Successfully reset!!', '');}}",
  "openModalOrarioEdit": "{{orariFunctions.modificaOrario(rowIndex);}}",
  "originalBottomRow": 51,
  "originalTopRow": 0,
  "parentColumnSpace": 20.25,
  "parentId": "iah993xew8",
  "parentRowSpace": 10,
  "renderMode": "CANVAS",
  "rightColumn": 64,
  "srcDoc": {
    "css": ".widget-outer-wrapper {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n\n.schedule {\n  font-family: Arial, sans-serif;\n  background-color: #f8f9fa;\n  padding: 20px;\n  border-radius: 8px;\n  box-shadow: var(--appsmith-theme-boxShadow);\n  display: flex;\n  overflow-x: auto;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.day-container {\n  margin-right: 20px;\n  min-width: 150px;\n}\n\n.day-header {\n  font-weight: bold;\n  margin-bottom: 10px;\n  text-align: center;\n}\n\n.time-slot {\n  margin-bottom: 10px;\n  padding: 10px;\n  border-radius: 4px;\n  background-color: #fff;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  position: relative;\n}\n\n.time-details {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  position: relative;\n  margin-bottom: 5px;\n}\n\n.total-hours {\n  font-size: 12px;\n  color: grey;\n  text-align: center;\n}\n\n.location-and-buttons {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-weight: bold;\n  margin-top: 5px;\n  width: 100%;\n}\n\n.location-and-buttons span {\n  display: block;\n  text-align: center;\n  width: 100%;\n}\n\n.district {\n  text-align: center;\n  font-size: 12px;\n  color: grey;\n}\n\n.menu-trigger {\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  background: none;\n  border: none;\n  font-size: 20px;\n  cursor: pointer;\n  z-index: 2;\n  transition: background 0.2s;\n  padding: 4px;\n  border-radius: 4px;\n}\n\n.menu-trigger:focus {\n  outline: 2px solid #2d74da;\n}\n\n.menu-popup {\n  position: absolute;\n  top: 34px;\n  right: 4px;\n  background: #fff;\n  border: 1px solid #eee;\n  border-radius: 7px;\n  box-shadow: 0 6px 16px 0 rgba(0, 0, 0, 0.2);\n  min-width: 140px;\n  z-index: 5;\n  display: flex;\n  flex-direction: column;\n  padding: 4px 0;\n}\n\n.menu-action {\n  display: flex;\n  align-items: center;\n  font-size: 15px;\n  border: none;\n  background: transparent;\n  padding: 8px 14px;\n  width: 100%;\n  cursor: pointer;\n  color: #333;\n  gap: 8px;\n  border-radius: 7px;\n  transition: background 0.18s, color 0.18s;\n}\n\n.menu-action.delete {\n  color: #dc3545;\n}\n\n.menu-action.edit {\n  color: #1565c0;\n}\n\n.menu-action:hover {\n  background: #f0f3f8;\n  color: #1565c0;\n}\n\n.menu-action.delete:hover {\n  background: #ffe5e8;\n  color: #a8301b;\n}\n\n.menu-action.edit:hover {\n  background: #eaf2fb;\n  color: #003366;\n}",
    "html": "<link\n  rel=\"stylesheet\"\n  href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\"\n/>\n<div id=\"root\"></div>",
    "js": "import React from 'https://cdn.jsdelivr.net/npm/react@18.2.0/+esm';\nimport ReactDOM from 'https://cdn.jsdelivr.net/npm/react-dom@18.2.0/+esm';\nfunction ScheduleWidget() {\n  // State to manage which menu is open (one at a time only)\n  const [openMenu, setOpenMenu] = React.useState(null); // 'day_index' string\n\n  const parseTime = timeStr => {\n    const [hours, minutes] = timeStr.split(':');\n    return new Date(0, 0, 0, parseInt(hours), parseInt(minutes));\n  };\n  const calculateTotalHours = (from, to) => {\n    const fromTime = parseTime(from);\n    const toTime = parseTime(to);\n    const hourDiff = (toTime - fromTime) / (1000 * 60 * 60);\n    return parseFloat(Math.abs(hourDiff).toFixed(2));\n  };\n\n  // Only use incoming model\n  const [schedule, setSchedule] = React.useState(appsmith.model);\n  React.useEffect(() => {\n    appsmith.onModelChange(newModel => {\n      setSchedule(newModel);\n      setOpenMenu(null); // chiudi qualsiasi menu quando aggiorna dati\n    });\n  }, []);\n  const handleEdit = rowIndex => {\n    appsmith.triggerEvent(\"openModalOrarioEdit\", {\n      rowIndex\n    });\n  };\n  const handleDelete = (day, index, rowIndex) => {\n    setOpenMenu(null);\n    const confirmDelete = confirm(`Sicuri di cancellare questo turno ${day}?`);\n    if (confirmDelete) {\n      const updatedSchedule = {\n        ...schedule\n      };\n      updatedSchedule[day].splice(index, 1);\n      setSchedule({\n        ...updatedSchedule\n      });\n      appsmith.triggerEvent(\"onDeleteOrario\", {\n        rowIndex\n      });\n    }\n  };\n  // Per chiudere il menu su click esterno\n  React.useEffect(() => {\n    function onDocClick(e) {\n      // Se c'Ã¨ menu aperto e si clicca fuori dal menu\n      if (openMenu && !e.target.closest('.menu-popup') && !e.target.closest('.menu-trigger')) {\n        setOpenMenu(null);\n      }\n    }\n    if (openMenu) document.addEventListener('mousedown', onDocClick);\n    return () => document.removeEventListener('mousedown', onDocClick);\n  }, [openMenu]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"widget-outer-wrapper\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"schedule\"\n  }, Object.entries(schedule || {}).map(([day, slots]) => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"day-container\",\n    key: day\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"day-header\"\n  }, day), (slots || []).map((slot, index) => {\n    const menuKey = `${day}_${index}`;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"time-slot\",\n      key: index\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"menu-trigger\",\n      onClick: () => setOpenMenu(openMenu === menuKey ? null : menuKey),\n      title: \"Azioni turno\",\n      tabIndex: 0,\n      \"aria-label\": \"Azioni turno\"\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-ellipsis-v\"\n    })), openMenu === menuKey && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"menu-popup\"\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"menu-action delete\",\n      onClick: () => handleDelete(day, index, slot.rowIndex)\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-trash\"\n    }), \" Elimina\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"menu-action edit\",\n      onClick: () => handleEdit(slot.rowIndex)\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fas fa-pen\"\n    }), \" Modifica\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"time-details\"\n    }, /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"span\", null, slot.from), \" - \", /*#__PURE__*/React.createElement(\"span\", null, slot.to), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"total-hours\"\n    }, calculateTotalHours(slot.from, slot.to), \" ore\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"location-and-buttons\"\n    }, /*#__PURE__*/React.createElement(\"span\", null, slot.location)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"district\"\n    }, /*#__PURE__*/React.createElement(\"span\", null, slot.district)));\n  })))));\n}\nappsmith.onReady(() => {\n  ReactDOM.render(/*#__PURE__*/React.createElement(ScheduleWidget, null), document.getElementById(\"root\"));\n});"
  },
  "theme": "{{appsmith.theme}}",
  "topRow": 0,
  "topRowBeforeCollapse": 0,
  "type": "CUSTOM_WIDGET",
  "uncompiledSrcDoc": {
    "css": ".widget-outer-wrapper {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n.schedule {\n  font-family: Arial, sans-serif;\n  background-color: #f8f9fa;\n  padding: 20px;\n  border-radius: 8px;\n  box-shadow: var(--appsmith-theme-boxShadow);\n  display: flex;\n  overflow-x: auto;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.day-container {\n  margin-right: 20px;\n  min-width: 150px;\n}\n\n.day-header {\n  font-weight: bold;\n  margin-bottom: 10px;\n  text-align: center;\n}\n\n.time-slot {\n  margin-bottom: 10px;\n  padding: 10px;\n  border-radius: 4px;\n  background-color: #fff;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n  position: relative;\n}\n\n.time-details {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  position: relative;\n  margin-bottom: 5px;\n}\n\n.total-hours {\n  font-size: 12px;\n  color: grey;\n  text-align: center;\n}\n\n.location-and-buttons {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-weight: bold;\n  margin-top: 5px;\n  width: 100%;\n}\n.location-and-buttons span {\n  display: block;\n  text-align: center;\n  width: 100%;\n}\n\n.district {\n  text-align: center;\n  font-size: 12px;\n  color: grey;\n}\n.menu-trigger {\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  background: none;\n  border: none;\n  font-size: 20px;\n  cursor: pointer;\n  z-index: 2;\n  transition: background 0.2s;\n  padding: 4px;\n  border-radius: 4px;\n}\n.menu-trigger:focus {\n  outline: 2px solid #2d74da;\n}\n.menu-popup {\n  position: absolute;\n  top: 34px;\n  right: 4px;\n  background: #fff;\n  border: 1px solid #eee;\n  border-radius: 7px;\n  box-shadow: 0 6px 16px 0 rgba(0,0,0,.2);\n  min-width: 140px;\n  z-index: 5;\n  display: flex;\n  flex-direction: column;\n  padding: 4px 0;\n}\n.menu-action {\n  display: flex;\n  align-items: center;\n  font-size: 15px;\n  border: none;\n  background: transparent;\n  padding: 8px 14px;\n  width: 100%;\n  cursor: pointer;\n  color: #333;\n  gap: 8px;\n  border-radius: 7px;\n  transition: background .18s, color .18s;\n}\n.menu-action.delete {\n  color: #dc3545;\n}\n.menu-action.edit {\n  color: #1565c0;\n}\n.menu-action:hover {\n  background: #f0f3f8;\n  color: #1565c0;\n}\n.menu-action.delete:hover {\n  background: #ffe5e8;\n  color: #a8301b;\n}\n.menu-action.edit:hover {\n  background: #eaf2fb;\n  color: #003366;\n}\n",
    "html": "<link\n  rel=\"stylesheet\"\n  href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\"\n/>\n<div id=\"root\"></div>",
    "js": "import React from 'https://cdn.jsdelivr.net/npm/react@18.2.0/+esm';\nimport ReactDOM from 'https://cdn.jsdelivr.net/npm/react-dom@18.2.0/+esm';\n\nfunction ScheduleWidget() {\n  // State to manage which menu is open (one at a time only)\n  const [openMenu, setOpenMenu] = React.useState(null); // 'day_index' string\n\n  const parseTime = (timeStr) => {\n    const [hours, minutes] = timeStr.split(':');\n    return new Date(0, 0, 0, parseInt(hours), parseInt(minutes));\n  };\n  const calculateTotalHours = (from, to) => {\n    const fromTime = parseTime(from);\n    const toTime = parseTime(to);\n    const hourDiff = (toTime - fromTime) / (1000 * 60 * 60);\n    return parseFloat(Math.abs(hourDiff).toFixed(2));\n  };\n\n  // Only use incoming model\n  const [schedule, setSchedule] = React.useState(appsmith.model);\n  React.useEffect(() => {\n    appsmith.onModelChange((newModel) => {\n      setSchedule(newModel);\n      setOpenMenu(null); // chiudi qualsiasi menu quando aggiorna dati\n    });\n  }, []);\n\n  const handleEdit = (rowIndex) => {\n    appsmith.triggerEvent(\"openModalOrarioEdit\", {rowIndex});\n  };\n  const handleDelete = (day, index, rowIndex) => {\n    setOpenMenu(null);\n    const confirmDelete = confirm(`Sicuri di cancellare questo turno ${day}?`);\n    if (confirmDelete) {\n      const updatedSchedule = { ...schedule };\n      updatedSchedule[day].splice(index, 1);\n      setSchedule({ ...updatedSchedule });\n      appsmith.triggerEvent(\"onDeleteOrario\", {rowIndex});\n    }\n  };\n  // Per chiudere il menu su click esterno\n  React.useEffect(() => {\n    function onDocClick(e) {\n      // Se c'Ã¨ menu aperto e si clicca fuori dal menu\n      if (openMenu && !e.target.closest('.menu-popup') && !e.target.closest('.menu-trigger')) {\n        setOpenMenu(null);\n      }\n    }\n    if (openMenu) document.addEventListener('mousedown', onDocClick);\n    return () => document.removeEventListener('mousedown', onDocClick);\n  }, [openMenu]);\n\n  return (\n    <div className=\"widget-outer-wrapper\">\n      <div className=\"schedule\">\n        {Object.entries(schedule || {}).map(([day, slots]) => (\n          <div className=\"day-container\" key={day}>\n            <div className=\"day-header\">{day}</div>\n            {(slots || []).map((slot, index) => {\n              const menuKey = `${day}_${index}`;\n              return (\n                <div className=\"time-slot\" key={index}>\n                  <button className=\"menu-trigger\" onClick={() => setOpenMenu(openMenu === menuKey ? null : menuKey)} title=\"Azioni turno\" tabIndex={0} aria-label=\"Azioni turno\">\n                    <i className=\"fas fa-ellipsis-v\"></i>\n                  </button>\n                  {openMenu === menuKey && (\n                    <div className=\"menu-popup\">\n                      <button className=\"menu-action delete\" onClick={() => handleDelete(day, index,slot.rowIndex)}>\n                        <i className=\"fas fa-trash\"></i> Elimina\n                      </button>\n                      <button className=\"menu-action edit\" onClick={() => handleEdit(slot.rowIndex)}>\n                        <i className=\"fas fa-pen\"></i> Modifica\n                      </button>\n                    </div>\n                  )}\n                  <div className=\"time-details\">\n                    <div>\n                      <span>{slot.from}</span> - <span>{slot.to}</span>\n                      <div className=\"total-hours\">\n                        {calculateTotalHours(slot.from, slot.to)} ore\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"location-and-buttons\">\n                    <span>{slot.location}</span>\n                  </div>\n                  <div className=\"district\">\n                    <span>{slot.district}</span>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nappsmith.onReady(() => {\n  ReactDOM.render(<ScheduleWidget />, document.getElementById(\"root\"));\n});"
  },
  "version": 1,
  "widgetId": "mz9x7fxjo8",
  "widgetName": "orarioConvenzionatiCustom"
}